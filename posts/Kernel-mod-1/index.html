<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Writing my first kernel module [1/n]" /><meta name="author" content="ThorriSnep" /><meta property="og:locale" content="en" /><meta name="description" content="Here I want to tell you about the motivation for developing kernel modules and what the hell even the kernel is:" /><meta property="og:description" content="Here I want to tell you about the motivation for developing kernel modules and what the hell even the kernel is:" /><link rel="canonical" href="https://thorrisnep.github.io//posts/Kernel-mod-1/" /><meta property="og:url" content="https://thorrisnep.github.io//posts/Kernel-mod-1/" /><meta property="og:site_name" content="Thorri" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-12-10T12:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Writing my first kernel module [1/n]" /><meta name="twitter:site" content="@ThorriSnep" /><meta name="twitter:creator" content="@ThorriSnep" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ThorriSnep"},"dateModified":"2021-12-23T21:36:13+01:00","datePublished":"2021-12-10T12:00:00+01:00","description":"Here I want to tell you about the motivation for developing kernel modules and what the hell even the kernel is:","headline":"Writing my first kernel module [1/n]","mainEntityOfPage":{"@type":"WebPage","@id":"https://thorrisnep.github.io//posts/Kernel-mod-1/"},"url":"https://thorrisnep.github.io//posts/Kernel-mod-1/"}</script><title>Writing my first kernel module [1/n] | Thorri</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Thorri"><meta name="application-name" content="Thorri"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> </a></div><div class="site-title mt-3"> <a href="/">Thorri</a></div><div class="site-subtitle font-italic">Just me playing around</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/ThorriSnep" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/ThorriSnep" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Writing my first kernel module [1/n]</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Writing my first kernel module [1/n]</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> ThorriSnep </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Dec 10, 2021, 12:00 PM +0100" >Dec 10, 2021<i class="unloaded">2021-12-10T12:00:00+01:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, Dec 23, 2021, 9:36 PM +0100" >Dec 23, 2021<i class="unloaded">2021-12-23T21:36:13+01:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="360 words">2 min read</span></div></div><div class="post-content"><p>Here I want to tell you about the motivation for developing kernel modules and what the hell even the kernel is:</p><h1 id="1-what-is-a-kernel">1. What is a kernel?</h1><p>Before even starting to write a kernel module it is probably important to know what a kernel even is. In short the kernel is the part of the operating system that manages the hardware and facilitates the communication of the software that runs on the system with that hardware. For us the most important job of the kernel will probably be memory management which entails the segregation of virtual memory into user space and kernel space. Why this is done we might go into at a later point. Another important job of the kernel is the interaction with devices through devices drivers.</p><p>We can in general differentiate between 3 differentiate kernel structures:</p><h2 id="1-monolithic-kernel">1. Monolithic kernel</h2><p>Here all features of the OS like the file system, scheduler, device drivers, memory management, basic and application inter process communication,… run in kernel mode.</p><h2 id="2-micro-kernel">2. Micro kernel</h2><p>Here the features of the OS are split into a minimal kernel which only possesses basic functionality like the scheduler, memory management and basic IPC leaving a minimal amount running in kernel mode. The rest of the functionality of the OS is handled by “servers” like a file system server or device drivers running in user mode.</p><h2 id="3-hybrid-kernel">3. Hybrid kernel</h2><p>A hybrid kernel tries to combine the benefits of the monolithic and micro kernel.</p><h1 id="2-what-else-is-needed-for-a-working-linux">2. What else is needed for a working Linux?</h1><p>In addition to the kernel there are 2 other components needed for any working Linux system. These are:</p><h2 id="1-the-boot-loader">1. The boot loader</h2><p>The boot loader is a small program that is started after the computer is turned on. Its functionality is to initiate the RAM and the non-volatile memory so that the components of the OS can be loaded.</p><h2 id="2-the-root-file-system">2. The root file system</h2><p>The root file system is the point on which all other file systems are mounted and together with the root directory <code class="language-plaintext highlighter-rouge">/</code> it forms the basis for the hierarchical file tree. Not to be confused with the home directory of the root user <code class="language-plaintext highlighter-rouge">/root</code>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/linux/'>Linux</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/linux/" class="post-tag no-text-decoration" >Linux</a> <a href="/tags/kernel/" class="post-tag no-text-decoration" >kernel</a> <a href="/tags/theory/" class="post-tag no-text-decoration" >theory</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Writing my first kernel module [1/n] - Thorri&url=https://thorrisnep.github.io//posts/Kernel-mod-1/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Writing my first kernel module [1/n] - Thorri&u=https://thorrisnep.github.io//posts/Kernel-mod-1/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Writing my first kernel module [1/n] - Thorri&url=https://thorrisnep.github.io//posts/Kernel-mod-1/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/kernel-mod-2/">Writing my first kernel module [2/n] [WIP]</a><li><a href="/posts/Kernel-mod-1/">Writing my first kernel module [1/n]</a><li><a href="/posts/first-post/">Welcome to my Blog!</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/kernel/">kernel</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/draft/">draft</a> <a class="post-tag" href="/tags/general/">general</a> <a class="post-tag" href="/tags/homeserver/">homeserver</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/pfsense/">pfSense</a> <a class="post-tag" href="/tags/theory/">theory</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/kernel-mod-2/"><div class="card-body"> <span class="timeago small" >Dec 10, 2021<i class="unloaded">2021-12-10T12:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writing my first kernel module [2/n] [WIP]</h3><div class="text-muted small"><p> In this post I want to go through how to get the kernel source-tree and how to build a kernel from it. For every one how doesn’t know yet: the kernel source-tree is a directory which contains all t...</p></div></div></a></div><div class="card"> <a href="/posts/homeserver-router/"><div class="card-body"> <span class="timeago small" >Feb 18<i class="unloaded">2022-02-18T12:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>My home server (host OS and pfSense)</h3><div class="text-muted small"><p> In this post I want to show you how you can set up a pfSense VM as your firewall and router and my first step in upgrading my home network and server. A quick overview of the steps we are going to...</p></div></div></a></div><div class="card"> <a href="/posts/first-post/"><div class="card-body"> <span class="timeago small" >Dec 9, 2021<i class="unloaded">2021-12-09T14:23:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Welcome to my Blog!</h3><div class="text-muted small"><p> There isn’t much to say yet, but the goal of my blog is to document some of my personal projects. Hopefully can also learn something on the way.</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/first-post/" class="btn btn-outline-primary" prompt="Older"><p>Welcome to my Blog!</p></a> <a href="/posts/kernel-mod-2/" class="btn btn-outline-primary" prompt="Newer"><p>Writing my first kernel module [2/n] [WIP]</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/thorrisnep">your_full_name</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/kernel/">kernel</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/draft/">draft</a> <a class="post-tag" href="/tags/general/">general</a> <a class="post-tag" href="/tags/homeserver/">homeserver</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/pfsense/">pfSense</a> <a class="post-tag" href="/tags/theory/">theory</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
